<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin/layout-admin.html}">

<section layout:fragment="content">
	<div class="card">
		<div
			class="card-header d-flex justify-content-between align-items-center">
			<h5 class="m-0">List Category</h5>
			<a class="btn btn-sm btn-primary" th:href="@{/admin/categories/add}">
				<i class="bi bi-plus-lg"></i> Add New
			</a>
		</div>

		<div class="card-body">
			<!-- Alert -->
			<div th:if="${message != null}"
				class="alert alert-primary d-flex align-items-center" role="alert">
				<i class="bi bi-info-circle me-2"></i>
				<div>[[${message}]]</div>
			</div>

			<!-- Search -->
			<form class="row g-2 mb-3"
				th:action="@{/admin/categories/searchpaginated}" method="get">
				<div class="col-md-6">
					<div class="input-group">
						<span class="input-group-text"><i class="bi bi-search"></i></span>
						<input type="text" class="form-control" name="name" id="name"
							placeholder="Nhập từ khóa để tìm" th:value="${name}">
					</div>
				</div>
				<div class="col-auto">
					<button class="btn btn-outline-primary">
						<i class="bi bi-funnel"></i> Search
					</button>
				</div>
			</form>

			<!-- No content -->
			<div th:if="${!categoryPage.hasContent()}"
				class="alert alert-warning" role="alert">
				<i class="bi bi-exclamation-triangle"></i> Không có dữ liệu.
			</div>

			<!-- Table -->
			<div class="table-responsive" th:if="${categoryPage.hasContent()}">
				<table class="table table-striped table-hover align-middle">
					<thead>
						<tr>
							<th style="width: 120px">Category ID</th>
							<th>Category Name</th>
							<th style="width: 160px" class="text-center">Action</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="category : ${categoryPage.content}">
							<td class="text-muted">[[${category.id}]]</td>
							<td class="fw-medium">[[${category.categoryName}]]</td>
							<td class="text-center">
								<div class="btn-group btn-group-sm">
									<a th:href="@{'/admin/categories/view/' + ${category.id}}"
										class="btn btn-outline-secondary" title="View"><i
										class="bi bi-eye"></i></a> <a
										th:href="@{'/admin/categories/edit/' + ${category.id}}"
										class="btn btn-outline-warning" title="Edit"><i
										class="bi bi-pencil"></i></a>
									<button type="button" class="btn btn-outline-danger"
										title="Delete"
										th:attr="data-id=${category.id},data-name=${category.categoryName}"
										onclick="showconfirmation(this.getAttribute('data-id'), this.getAttribute('data-name'))">
										<i class="bi bi-trash"></i>
									</button>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>

			<!-- Page size -->
			<form class="d-inline-block me-3"
				th:action="@{/admin/categories/searchpaginated}" method="get">
				<input type="hidden" name="name" th:value="${name}"> <input
					type="hidden" name="page" value="1"> <label
					class="small me-2 text-muted">Page size:</label> <select
					class="form-select form-select-sm d-inline-block w-auto"
					name="size" id="size" onchange="this.form.submit()">
					<option th:selected="${categoryPage.size == 5}" value="5">5</option>
					<option th:selected="${categoryPage.size == 10}" value="10">10</option>
					<option th:selected="${categoryPage.size == 15}" value="15">15</option>
					<option th:selected="${categoryPage.size == 20}" value="20">20</option>
				</select>
			</form>

			<!-- Pagination -->
			<nav th:if="${categoryPage.totalPages > 0}"
				aria-label="Page navigation" class="d-inline-block">
				<ul class="pagination pagination-sm mb-0">
					<li class="page-item"
						th:classappend="${categoryPage.number == 0}? 'disabled'"><a
						class="page-link"
						th:href="@{/admin/categories/searchpaginated(name=${name},size=${categoryPage.size},page=${1})}">First</a>
					</li>
					<li class="page-item" th:each="pageNumber : ${pageNumbers}"
						th:classappend="${pageNumber == categoryPage.number + 1}? 'active'">
						<a class="page-link" th:text="${pageNumber}"
						th:href="@{/admin/categories/searchpaginated(name=${name},size=${categoryPage.size},page=${pageNumber})}">1</a>
					</li>
					<li class="page-item"
						th:classappend="${categoryPage.number+1 == categoryPage.totalPages}? 'disabled'">
						<a class="page-link"
						th:href="@{/admin/categories/searchpaginated(name=${name},size=${categoryPage.size},page=${categoryPage.totalPages})}">Last</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>

	<!-- Delete Modal -->
	<div class="modal fade" id="confirmationId" tabindex="-1"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">
						<i class="bi bi-question-circle me-2"></i>Confirmation
					</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body">
					Bạn có muốn xoá <strong id="productName"></strong>?
				</div>
				<div class="modal-footer">
					<a id="yesOption" class="btn btn-danger"><i class="bi bi-trash"></i>
						Yes</a>
					<button type="button" class="btn btn-secondary"
						data-bs-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>

	<script th:inline="javascript">
		function showconfirmation(id, name) {
			document.getElementById('productName').textContent = name;
			document.getElementById('yesOption').setAttribute('href', /*[[${'/admin/categories/delete/'}]]*/
					'/admin/categories/delete/' + id);
			new bootstrap.Modal(document.getElementById('confirmationId'))
					.show();
		}
	</script>
</section>
</html>
